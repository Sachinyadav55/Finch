%\VignetteEngine{knitr::knitr}
\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}


%%%%%%%%%%%%%%%%
%%% Preamble %%%
%%%%%%%%%%%%%%%%

%%% Title %%%
\newcommand{\thetitle}{Finch: Pairwise distance base on kmer strategy}

%%% Packages %%%
\usepackage{whbiocvignette}
\usepackage[numbers]{natbib}

%%% Title Material %%%
\title{}
\title{\textsf{\textbf{\thetitle}}}

\author{
	Cai Huang\\[1em]Georgia Instutute of Technology,\\ Atlanta, GA, USA\\ \texttt{chuang95@gatech.edu}
	\and
	Fredrik O. Vannberg\\[1em]Georgia Instutute of Technology,\\ Atlanta, GA, USA\\ \texttt{fredrik.vannberg@biology.gatech.edu}
}


%%%%%%%%%%%%%%%%
%%% Document %%%
%%%%%%%%%%%%%%%%
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}



%%% Title %%%
\maketitle


%%%%%%%%%%%%%%%%
%%% Abstract %%%
%%%%%%%%%%%%%%%%
\abstract

To date the comparison of genomic DNA sequences have routinely utilized shorter conserved regions for comparative genomics. Current phylogenetic analysis therefore can create divergent results based on which genetic loci are utilized for this analysis. Sequence similarity is also commonly determined by first carrying out gap penalty pairwise alignments for a set of sequences, and the similarity is quantified based upon this alignment. This approach, however, has limitations and is primarily utilized to compare relatively conserved sequences and is also de- pendent upon the algorithm utilized to create the alignment. From first principles we here develop a framework for encoding nucleic acid sequences into fixed length sections (k-mers) which we utilize to create an invariant pairwise distance of total information content of genome sequences. Here we provide a R package which has two kmer base algorithms to compute the pairwise comparison of genomic DNA sequence. First function is Boolean analysis by using XOR discrete function, second function is linear algebra analysis by using hierarchical PCA.


%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Table of contents %%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Loading the R package %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Loading the R package}
\label{sec.loading}

First, download and install the \Rpackage{Finch} R package. Launch R and load the package.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{require}\hlstd{(Matrix)}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# Loading required package: Matrix\\\#\# Loading required package: methods}}\begin{alltt}
\hlkwd{library}\hlstd{(Finch)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in library(Finch): there is no package called 'Finch'}}\end{kframe}
\end{knitrout}

The examples in this document are integer kc files generated by using Kanalyze\cite{Audano:2014aa} with following command.
\[{\rm{ls *fna | xargs  - I one java  - jar kanalyze.jar count  - k 8  - o one\_8.kc  - f fasta  - p kanalyze.outfmt = int  - r one}}\]

The kc files contents kmer and counts for each genome sequence. In our test data set, there are 6 kc files generated from 6 virus genome sequences, and we choose kmer length equal to 8

%%%%%%%%%%%%%%%%%%%%%%%%
%%% Finch by xor %%%
%%%%%%%%%%%%%%%%%%%%%%%%
\section{Compute pairwise distance by using XOR}
\label{Finch.dif}

The first function \Rfunction{Finch.dif} compute pairwise distance of kmer data by using XOR discrete function, and we call it boolean analysis. We can call this function.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{x} \hlkwb{<-} \hlkwd{Finch.dif}\hlstd{(}\hlnum{8}\hlstd{,}\hlstr{"../../Finch/data"}\hlstd{)} \hlcom{#kmer.length = 8, path.to.data to data folder}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): could not find function "{}Finch.dif"{}}}\end{kframe}
\end{knitrout}

The \texttt{x} return value is a distance matrix. Each column and row represents one virus genome. We can check the distance matrix.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{names}\hlstd{(x)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'x' not found}}\begin{alltt}
\hlkwd{names}\hlstd{(x)} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{6}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in names(x) <- c(1:6): object 'x' not found}}\begin{alltt}
\hlstd{x}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'x' not found}}\end{kframe}
\end{knitrout}

First 3 virus are \emph{Mycobacterium.phage} and last 3 are \emph{Staphylococcus.phage}. From the matrix, we see the pairwise distance among first 3 genomes and last 3 genomes are lower than the pairwise distance across the them. Base on this, we can clearly cluster them to two family.\\


%%%%%%%%%%%%%%%%%%%%%%%%
%%% Finch by hPCA %%%
%%%%%%%%%%%%%%%%%%%%%%%%
\section{Compute pairwise distance by using hierarchical PCA}
\label{Finch.hpca}

The second function. \Rfunction{Finch.hpca} compute the pairwise distance of kmer data by using hierarchical PCA, and we call it linear algebra analysis. We can call this function.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{y} \hlkwb{<-} \hlkwd{Finch.hpca}\hlstd{(}\hlnum{8}\hlstd{,}\hlstr{"../../Finch/data"}\hlstd{)} \hlcom{#kmer.length = 8, path.to.data to data folder}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): could not find function "{}Finch.hpca"{}}}\end{kframe}
\end{knitrout}

This function also  returns \texttt{y} value as a distance matrix. Each column and row represents one virus genome. We can check the distance matrix.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{names}\hlstd{(y)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'y' not found}}\begin{alltt}
\hlkwd{names}\hlstd{(y)} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{6}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in names(y) <- c(1:6): object 'y' not found}}\begin{alltt}
\hlstd{y}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'y' not found}}\end{kframe}
\end{knitrout}

Similarly, we see the pairwise distance are clearly separating the two group of viruses.\\


%%%%%%%%%%%%%%%%%%%%%%%%
%%% compare the result%%%
%%%%%%%%%%%%%%%%%%%%%%%%
\section{Compare the results generated by XOR and hierarchical PCA}
\label{Finch.dif}

Further more, we plot the \texttt{x} and \texttt{y} pairwise distance matrix together, and show the nice correlation between our two algorithm.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{#prepare the result as vector}
\hlstd{x}\hlkwb{=}\hlkwd{as.vector}\hlstd{(}\hlkwd{data.matrix}\hlstd{(x))}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in as.vector(data.matrix(x)): error in evaluating the argument 'x' in selecting a method for function 'as.vector': Error in is.data.frame(frame) : object 'x' not found\\\#\# Calls: data.matrix -> is.data.frame}}\begin{alltt}
\hlstd{y}\hlkwb{=}\hlkwd{as.vector}\hlstd{(}\hlkwd{data.matrix}\hlstd{(y))}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in as.vector(data.matrix(y)): error in evaluating the argument 'x' in selecting a method for function 'as.vector': Error in is.data.frame(frame) : object 'y' not found\\\#\# Calls: data.matrix -> is.data.frame}}\begin{alltt}
\hlcom{#log transfer data }
\hlstd{x[x}\hlopt{>}\hlnum{0}\hlstd{]}\hlkwb{=}\hlopt{-}\hlkwd{log}\hlstd{(x[x}\hlopt{>}\hlnum{0}\hlstd{])}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'x' not found}}\begin{alltt}
\hlstd{y[y}\hlopt{>}\hlnum{0}\hlstd{]}\hlkwb{=}\hlopt{-}\hlkwd{log}\hlstd{(y[y}\hlopt{>}\hlnum{0}\hlstd{])}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'y' not found}}\begin{alltt}
\hlcom{#fit a linear regression model to show the correlation between x and y }
\hlstd{reg}\hlkwb{=}\hlkwd{lm}\hlstd{(x}\hlopt{~}\hlstd{y)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'x' not found}}\begin{alltt}
\hlkwd{plot}\hlstd{(x, y,}\hlkwc{xlab}\hlstd{=}\hlstr{"Boolean analysis"}\hlstd{,}\hlkwc{ylab}\hlstd{=}\hlstr{"hierarchical PCA"}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in plot(x, y, xlab = "{}Boolean analysis"{}, ylab = "{}hierarchical PCA"{}): object 'x' not found}}\begin{alltt}
\hlkwd{title}\hlstd{(}\hlkwc{main}\hlstd{=}\hlstr{"Boolean analysis compare with hierarchical PCA"}\hlstd{,} \hlkwc{col.main}\hlstd{=}\hlstr{"black"}\hlstd{,} \hlkwc{font.main}\hlstd{=}\hlnum{4}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in title(main = "{}Boolean analysis compare with hierarchical PCA"{}, : plot.new has not been called yet}}\begin{alltt}
\hlkwd{abline}\hlstd{(reg)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in abline(reg): object 'reg' not found}}\begin{alltt}
\hlcom{#show the coefficient of determination}
\hlkwd{summary}\hlstd{(reg)}\hlopt{$}\hlstd{r.squared}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in summary(reg): error in evaluating the argument 'object' in selecting a method for function 'summary': Error: object 'reg' not found}}\end{kframe}
\end{knitrout}

From the plot we can see the linear regression model shows a good correlation between our two function with 0.8295 R squared score  . Also the dots are located to two separate parts of the plot, which give us the evidence of two clusters among the genome data.


%%%%%%%%%%%%%%%%%%%%
%%% Session info %%%
%%%%%%%%%%%%%%%%%%%%
\section{Session info}
\label{sec.sessioninfo}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{sessionInfo}\hlstd{()}
\end{alltt}
\begin{verbatim}
## R version 3.0.3 (2014-03-06)
## Platform: x86_64-apple-darwin10.8.0 (64-bit)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] methods   stats     graphics  grDevices utils     datasets  base     
## 
## other attached packages:
## [1] Matrix_1.1-5 knitr_1.9   
## 
## loaded via a namespace (and not attached):
## [1] evaluate_0.5.5  formatR_1.0     grid_3.0.3      highr_0.4      
## [5] lattice_0.20-29 stringr_0.6.2   tools_3.0.3
\end{verbatim}
\end{kframe}
\end{knitrout}

%%%%%%%%%%%%%%%%%%%%
%%% Bibliography %%%
%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{natbib}
\bibliography{Finch}

\end{document}
